# ReportViewer Component

## Overview

The `ReportViewer` component is a comprehensive, accessible UI component for displaying UX analysis reports generated by the AutoUX AI system. It provides advanced filtering, search, and navigation capabilities while maintaining full keyboard accessibility and WCAG 2.2 compliance.

## Features

### Core Functionality
- ✅ **Issues Display**: Shows all detected UX issues with detailed information
- ✅ **Grouped View**: Organizes issues by category for better comprehension
- ✅ **Flat List View**: Alternative view mode for linear browsing
- ✅ **Expandable Cards**: Click to expand/collapse issue details
- ✅ **Severity Badges**: Color-coded badges with accessible labels

### Filtering & Search
- ✅ **Search**: Full-text search across issue descriptions
- ✅ **Severity Filter**: Filter by critical, high, medium, or low severity
- ✅ **Type Filter**: Filter by issue type (latency, accessibility, contrast, etc.)
- ✅ **Category Filter**: Filter by custom categories
- ✅ **Clear Filters**: One-click to reset all filters

### Accessibility
- ✅ **Keyboard Navigation**: Full keyboard support (Tab, Enter, Space)
- ✅ **ARIA Labels**: Proper semantic HTML and ARIA attributes
- ✅ **Focus Indicators**: Clear visual focus states
- ✅ **Screen Reader Support**: Descriptive labels and live regions
- ✅ **Color Contrast**: WCAG AA compliant color ratios

### Metadata Display
- ✅ **Issue Details**: ID, type, category, timestamp, source log
- ✅ **Additional Metadata**: Expandable section for custom metadata
- ✅ **Formatted Display**: Clean, readable presentation of technical data

## Props

| Prop | Type | Required | Description |
|------|------|----------|-------------|
| `report` | `Object` | Yes | The AI-generated report object |
| `markdown` | `String` | No | Markdown version of the report (optional) |

### Report Object Structure

```javascript
{
  id: string,                    // Unique report identifier
  timestamp: string,             // ISO 8601 timestamp
  uxScore: number,               // 0-100 UX score
  issues: Array<Issue>,          // Array of detected issues
  topIssues: Array<Issue>,       // Alternative issues array (LLM data)
  recommendations: Array<Object> // AI recommendations (optional)
}
```

### Issue Object Structure

```javascript
{
  id: string,                    // Unique issue identifier
  type: string,                  // Issue type (latency, accessibility, etc.)
  category: string,              // Issue category (optional)
  severity: string,              // critical | high | medium | low
  description: string,           // Human-readable description
  timestamp: string,             // ISO 8601 timestamp (optional)
  sourceLogId: string,           // Source log identifier (optional)
  metadata: Object               // Additional metadata (optional)
}
```

## Usage

### Basic Usage

```jsx
import ReportViewer from './components/ReportViewer.jsx';

function App() {
  const [report, setReport] = useState(null);

  return (
    <div>
      {report && <ReportViewer report={report} />}
    </div>
  );
}
```

### With Markdown

```jsx
import ReportViewer from './components/ReportViewer.jsx';

function App() {
  const [report, setReport] = useState(null);
  const [markdown, setMarkdown] = useState('');

  return (
    <div>
      {report && (
        <ReportViewer 
          report={report} 
          markdown={markdown}
        />
      )}
    </div>
  );
}
```

### Integration with API

```jsx
import { useState } from 'react';
import { uploadLogs } from './services/api.js';
import ReportViewer from './components/ReportViewer.jsx';

function App() {
  const [report, setReport] = useState(null);
  const [loading, setLoading] = useState(false);

  const handleUpload = async (file) => {
    setLoading(true);
    try {
      const result = await uploadLogs([file]);
      setReport(result);
    } catch (error) {
      console.error('Upload failed:', error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div>
      <FileUploader onUpload={handleUpload} />
      {loading && <LoadingSpinner />}
      {report && <ReportViewer report={report} />}
    </div>
  );
}
```

## Keyboard Navigation

| Key | Action |
|-----|--------|
| `Tab` | Navigate between interactive elements |
| `Shift + Tab` | Navigate backwards |
| `Enter` or `Space` | Expand/collapse issue cards |
| `Escape` | Clear search (when focused on search input) |

## Styling

The component uses inline styles for maximum portability and consistency. All colors are WCAG AA compliant:

- **Critical Severity**: Red (#dc2626) on light red background (#fef2f2)
- **High Severity**: Orange (#d97706) on light orange background (#fffbeb)
- **Medium Severity**: Green (#16a34a) on light green background (#f0fdf4)
- **Low Severity**: Gray (#6b7280) on light gray background (#f3f4f6)

## Accessibility Features

### ARIA Attributes
- `role="region"` on main container
- `aria-label` on all interactive elements
- `aria-expanded` on expandable cards
- `aria-controls` linking buttons to content
- `aria-live="polite"` on status messages

### Focus Management
- Clear focus indicators (2px blue outline)
- Logical tab order
- Focus visible on all interactive elements

### Screen Reader Support
- Descriptive labels for all controls
- Status updates announced via live regions
- Semantic HTML structure

## Performance

- **Memoization**: Uses `useMemo` for expensive filtering operations
- **Efficient Rendering**: Only re-renders when props or state change
- **Lazy Expansion**: Issue details only rendered when expanded

## Browser Support

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

## Related Components

- `SeverityBadge.jsx` - Displays severity indicators
- `IssueList.jsx` - Alternative simpler issue list
- `IssueDetail.jsx` - Standalone issue detail view

## Requirements Fulfilled

This component fulfills the following requirements from the AutoUX specification:

- **Requirement 2.3**: Display issues with severity badges and filtering
- **Requirement 2.4**: Implement search and expandable issue details
- **Requirement 6.5**: Ensure keyboard navigation and accessibility

## Testing

See `ReportViewer.test.jsx` for comprehensive test coverage including:
- Rendering with various data states
- Filtering and search functionality
- Keyboard navigation
- Accessibility compliance
- Edge cases and error handling

## Future Enhancements

Potential improvements for future versions:
- Export filtered results to CSV/JSON
- Bulk actions (mark as resolved, etc.)
- Custom sorting options
- Saved filter presets
- Issue comparison view
- Timeline visualization
